<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8">
<title>Táº¡o bÃ i há»c</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-[#fcfbf8] font-sans">

<div class="max-w-5xl mx-auto p-6 space-y-4">

<h1 class="text-3xl font-black">âœï¸ Táº O BÃ€I Há»ŒC</h1>

<input id="title" placeholder="Nháº­p tiÃªu Ä‘á» bÃ i há»c..."
 class="w-full p-3 text-xl font-bold rounded-lg border">

<!-- TOOLBAR -->
<div class="flex flex-wrap gap-2 bg-white p-3 rounded-lg shadow">

<button onclick="cmd('bold')" class="px-3 py-1 border rounded font-bold">B</button>
<button onclick="cmd('italic')" class="px-3 py-1 border rounded italic">I</button>

<button onclick="insertImage()" class="px-3 py-1 border rounded">ğŸ–¼ áº¢nh</button>
<button onclick="insertVideo()" class="px-3 py-1 border rounded">ğŸ¬ Video</button>
<button onclick="insertPPT()" class="px-3 py-1 border rounded">ğŸ“Š PPT</button>

<button onclick="insertFillBlank()" class="px-3 py-1 border rounded">âœï¸ Äiá»n khuyáº¿t</button>
<button onclick="insertMCQ()" class="px-3 py-1 border rounded">ğŸ…°ï¸ Tráº¯c nghiá»‡m</button>
<button onclick="insertMatch()" class="px-3 py-1 border rounded">ğŸ”— GhÃ©p Ä‘Ã´i</button>

</div>

<!-- EDITOR -->
<div id="editor" contenteditable="true"
 class="min-h-[420px] bg-white p-4 rounded-lg border leading-relaxed">
<p>ğŸ‘‰ Nháº­p ná»™i dung bÃ i há»c á»Ÿ Ä‘Ã¢y...</p>
</div>

<!-- ACTION -->
<div class="flex gap-4 pt-4">
<button onclick="preview()"
 class="bg-blue-500 text-white px-6 py-3 rounded-xl font-bold">
ğŸ‘€ Xem trÆ°á»›c
</button>

<button onclick="exportHTML()"
 class="bg-green-500 text-white px-6 py-3 rounded-xl font-bold">
ğŸ’¾ Xuáº¥t HTML
</button>
</div>

</div>

<script>
const editor = document.getElementById("editor");

function cmd(c){
  document.execCommand(c,false,null);
}

/* ===== MEDIA ===== */
function insertImage(){
  let url = prompt("DÃ¡n link áº£nh:");
  if(url){
    editor.insertAdjacentHTML("beforeend",
      '<img src="'+url+'" class="my-4 rounded max-w-full">');
  }
}

function insertVideo(){
  let url = prompt("DÃ¡n link YouTube:");
  if(!url) return;
  let id = url.split("v=")[1] || url.split("/").pop();
  editor.insertAdjacentHTML("beforeend",
    '<iframe class="my-4" width="100%" height="360" '+
    'src="https://www.youtube.com/embed/'+id+'" allowfullscreen></iframe>');
}

function insertPPT(){
  let url = prompt("DÃ¡n link Google Slides:");
  if(!url) return;
  let embed = url.replace("/edit","/embed");
  editor.insertAdjacentHTML("beforeend",
    '<iframe class="my-4" src="'+embed+
    '" width="100%" height="480" allowfullscreen></iframe>');
}

/* ===== BÃ€I Táº¬P ===== */
function insertFillBlank(){
  let q = prompt("Nháº­p cÃ¢u há»i:");
  let a = prompt("Nháº­p Ä‘Ã¡p Ã¡n Ä‘Ãºng:");
  if(!q||!a) return;
  editor.insertAdjacentHTML("beforeend",`
  <div class="exercise my-4 p-4 border rounded bg-yellow-50">
    <p class="font-semibold">${q}</p>
    <input class="border p-2 rounded mt-2"
      data-answer="${a}">
    <button onclick="checkFill(this)"
      class="ml-2 px-3 py-1 bg-blue-500 text-white rounded">
      Kiá»ƒm tra
    </button>
    <span class="ml-2 result"></span>
  </div>`);
}

function checkFill(btn){
  let input = btn.previousElementSibling;
  let r = btn.nextElementSibling;
  r.innerHTML =
    input.value.trim().toLowerCase() === input.dataset.answer.toLowerCase()
    ? "âœ… ÄÃºng" : "âŒ Sai";
  r.style.color = r.innerHTML.includes("ÄÃºng") ? "green" : "red";
}

function insertMCQ(){
  let q = prompt("CÃ¢u há»i:");
  let a = prompt("ÄÃ¡p Ã¡n Ä‘Ãºng (A/B/C/D):").toUpperCase();
  if(!q||!a) return;
  let name = "q"+Date.now();
  editor.insertAdjacentHTML("beforeend",`
  <div class="exercise my-4 p-4 border rounded bg-green-50" data-answer="${a}">
    <p class="font-semibold">${q}</p>
    <label><input type="radio" name="${name}" value="A"> A</label><br>
    <label><input type="radio" name="${name}" value="B"> B</label><br>
    <label><input type="radio" name="${name}" value="C"> C</label><br>
    <label><input type="radio" name="${name}" value="D"> D</label><br>
    <button onclick="checkMCQ(this)"
      class="mt-2 px-3 py-1 bg-blue-500 text-white rounded">
      Kiá»ƒm tra
    </button>
    <span class="ml-2 result"></span>
  </div>`);
}

function checkMCQ(btn){
  let box = btn.parentElement;
  let ans = box.dataset.answer;
  let checked = box.querySelector("input:checked");
  let r = btn.nextElementSibling;
  r.innerHTML = checked && checked.value===ans ? "âœ… ÄÃºng":"âŒ Sai";
  r.style.color = r.innerHTML.includes("ÄÃºng") ? "green":"red";
}

function insertMatch(){
  editor.insertAdjacentHTML("beforeend",`
  <div class="exercise my-4 p-4 border rounded bg-purple-50">
    <p class="font-semibold mb-2">GhÃ©p Ä‘Ãºng:</p>
    <div class="grid grid-cols-2 gap-2">
      <div>Con mÃ¨o</div>
      <select data-answer="meo">
        <option value="">-- chá»n --</option>
        <option value="meo">Meo meo</option>
        <option value="gau">GÃ¢u gÃ¢u</option>
      </select>
      <div>Con chÃ³</div>
      <select data-answer="gau">
        <option value="">-- chá»n --</option>
        <option value="meo">Meo meo</option>
        <option value="gau">GÃ¢u gÃ¢u</option>
      </select>
    </div>
    <button onclick="checkMatch(this)"
      class="mt-3 px-3 py-1 bg-blue-500 text-white rounded">
      Kiá»ƒm tra
    </button>
    <span class="ml-2 result"></span>
  </div>`);
}

function checkMatch(btn){
  let ok = true;
  btn.parentElement.querySelectorAll("select")
    .forEach(s=>{ if(s.value!==s.dataset.answer) ok=false; });
  let r = btn.nextElementSibling;
  r.innerHTML = ok ? "âœ… ÄÃºng":"âŒ Sai";
  r.style.color = ok ? "green":"red";
}

/* ===== PREVIEW + EXPORT ===== */
function preview(){
  let w = window.open();
  w.document.write(
    '<html><head><title>Xem trÆ°á»›c</title>'+
    '<script src="https://cdn.tailwindcss.com"><\/script>'+
    '</head><body class="p-6">'+
    '<h1 class="text-3xl font-bold mb-4">'+
    document.getElementById("title").value+
    '</h1>'+editor.innerHTML+
    '</body></html>');
}

function exportHTML(){
  let html =
'<!DOCTYPE html><html lang="vi"><head><meta charset="utf-8">'+
'<title>'+title.value+'</title>'+
'<script src="https://cdn.tailwindcss.com"><\/script></head>'+
'<body class="bg-[#fcfbf8] p-6">'+
'<h1 class="text-3xl font-bold mb-4">'+title.value+'</h1>'+
editor.innerHTML+
'</body></html>';

  let blob = new Blob([html],{type:"text/html"});
  let a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "bai-hoc.html";
  a.click();
}
</script>

</body>
</html>
